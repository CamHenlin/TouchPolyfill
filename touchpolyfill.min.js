(function(){function a(){function t(e,t,n,r,i,s,o,u){this.identifier=e;this.target=t;this.screenX=n;this.screenY=r;this.clientX=i;this.clientY=s;this.pageX=o;this.pageY=u}function n(t){var n;for(n=0;n<e.length;n+=1){if(e[n].identifier===t){return e[n]}}}function r(t){var n;for(n=0;n<e.length;n+=1){if(e[n].identifier===t.identifier){e[n]=t;return}}e.push(t)}function i(t){var n;for(n=0;n<e.length;n+=1){if(e[n].identifier===t){e.splice(n,1)}}}function s(){while(e.length>0){e.pop()}}function o(t,n){var r;for(r=0;r<e.length;r+=1){if(e[r].screenX===t&&e[r].screenY===n){return true}}return false}var e=[];this.touchList=e;this.Touch=t;this.getTouch=n;this.addUpdateTouch=r;this.removeTouch=i;this.clearTouches=s;this.containsTouchAt=o}function f(e,t){return e.screenX===t.screenX&&e.screenY===t.screenY}function l(e,t){var n;t=t||{bubbles:false,cancelable:false,detail:undefined};n=document.createEvent("CustomEvent");n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail);return n}function c(e){while(e&&!e.handJobjs_forcePreventDefault){e=e.parentNode}return!!e||window.handJobjs_forcePreventDefault}function h(t,n,r,i,a){function d(e,t){var n,r;u.clearTouches();for(n=0;n<t.length;n++){r=t[n];if(r.target.isSameNode(e)){u.addUpdateTouch(r)}}}function v(t){var n,r,i,a,c;k("touch!");if(t.type==="pointerdown"){n="touchstart"}else if(t.type==="pointermove"){n="touchmove"}else{throw new Error("touchHandler received invalid event type: "+n+". Valid event types are pointerdown and pointermove")}k(n);i=new s.Touch(t.pointerId,t.type==="pointerdown"?t.target:p,t.screenX,t.screenY,t.clientX,t.clientY,t.pageX,t.pageY);if(t.hwTimestamp>e){(function(){var e,t,n,r,i;t=o.touchList;for(e=0;e<t.length;e+=1){n=t[e];i=n.identifier;r=s.getTouch(i);if(!r||f(r,n)){o.removeTouch(i)}}})()}k("generating touch cloned");s.addUpdateTouch(i);o.addUpdateTouch(i);d(i.target,s.touchList);t.type=n;a=new l(n,{bubbles:true,cancelable:true});a.touches=s.touchList;a.changedTouches=o.touchList;a.targetTouches=u.touchList;a.type=n;return a}function m(t){var n,r,i;k("touchchanged!");t.changedTouches=[];t.changedTouches.length=1;t.changedTouches[0]=t;t.changedTouches[0].identifier=t.pointerId;if(t.type==="pointerup"){n="touchend"}else if(t.type==="pointercancel"){n="touchcancel"}else if(t.type==="pointerleave"){n="touchleave"}r=new s.Touch(t.pointerId,p,t.screenX,t.screenY,t.screenX,t.clientY,t.pageX,t.pageY);if(t.hwTimestamp>e){o.clearTouches()}s.removeTouch(r.identifier);o.addUpdateTouch(r);d(r.target,s.touchList);t.type=n;i=new l(n,{bubbles:true,cancelable:true});i.touches=s.touchList;i.changedTouches=o.touchList;i.targetTouches=u.touchList;i.type=n;return i}var c,h,p;if(t.type!=="pointerdown"){h=s.getTouch(t.pointerId);p=h.target;t.target=p}if(t.type==="pointerdown"||t.type==="pointermove"){c=v(t)}else{c=m(t)}c.preventDefault=function(){if(t.preventDefault!==undefined){t.preventDefault()}};k("dispatching!");t.target.dispatchEvent(c);e=event.hwTimestamp}function p(e,t,n,r,i,s){h(t,e,i,n,s)}function d(e,t,n,r){k("registerOrUnregisterEvent");if(e.__handJobjsRegisteredEvents===undefined){e.__handJobjsRegisteredEvents=[]}if(r){if(e.__handJobjsRegisteredEvents[t]!==undefined){e.__handJobjsRegisteredEvents[t]+=1;return}e.__handJobjsRegisteredEvents[t]=1;k("adding event "+t);e.addEventListener(t,n,false)}else{if(e.__handJobjsRegisteredEvents.indexOf(t)!==-1){e.__handJobjsRegisteredEvents[t]-=1;if(e.__handJobjsRegisteredEvents[t]!==0){return}}k("removing event");e.removeEventListener(t,n);e.__handJobjsRegisteredEvents[t]=0}}function v(e,t,n){function s(e){return e}var r,i;k("setTouchAware "+n+" "+t);if(!e.__handJobjsGlobalRegisteredEvents){e.__handJobjsGlobalRegisteredEvents=[]}if(n){if(e.__handJobjsGlobalRegisteredEvents[t]!==undefined){e.__handJobjsGlobalRegisteredEvents[t]+=1;return}e.__handJobjsGlobalRegisteredEvents[t]=1;k(e.__handJobjsGlobalRegisteredEvents[t])}else{if(e.__handJobjsGlobalRegisteredEvents[t]!==undefined){e.__handJobjsGlobalRegisteredEvents[t]-=1;if(e.__handJobjsGlobalRegisteredEvents[t]<0){e.__handJobjsGlobalRegisteredEvents[t]=0}}}r=h;i=s(t);if(e["on"+i.toLowerCase()]!==undefined){d(e,i,function(e){r(e,t)},n)}}function m(e){function n(e,n,i){k("customAddEventListener");k(e);if(r.indexOf(e)!==-1){k("setting touch aware...");v(this,e,true)}t.call(this,e,n,i)}var t=e.prototype?e.prototype.addEventListener:e.addEventListener;k("intercepting add event listener!");k(e);if(e.prototype){e.prototype.addEventListener=n}else{e.addEventListener=n}}function g(e,t){k("handle other event");if(e.preventManipulation){e.preventManipulation()}h(touchPoint,t)}function y(e,t){if(e.ontouchdown!==undefined){return}if(e.ontouchstart!==undefined){switch(t.toLowerCase()){case"touchstart":e.removeEventListener("pointerdown",function(e){g(e,t)});break;case"touchmove":e.removeEventListener("pointermove",function(e){g(e,t)});break;case"touchend":e.removeEventListener("pointerup",function(e){g(e,t)});break;case"touchcancel":e.removeEventListener("pointercancel",function(e){g(e,t)});break}}}function b(e){function n(e,n,i){if(r.indexOf(e)!==-1){y(this,e)}t.call(this,e,n,i)}var t=e.prototype?e.prototype.removeEventListener:e.removeEventListener;if(e.prototype){e.prototype.removeEventListener=n}else{e.removeEventListener=n}}function w(e,t){k("checkEventRegistration");return e.__handJobjsGlobalRegisteredEvents&&e.__handJobjsGlobalRegisteredEvents[t]}function E(e,t){k("findEventRegisteredNode");while(e&&!w(e,t)){e=e.parentNode}if(e){return e}if(w(window,t)){return window}}function S(e,t,n,r,i,s){k("generateTouchEventProxyIfRegistered");if(E(n,e)){p(e,t,n,r,i,s)}}function x(e){var t=[];if(e){t.unshift(e);while(e.parentNode){t.unshift(e.parentNode);e=e.parentNode}}return t}function T(e,t){var n=x(e),r=x(t),i=null;while(n.length>0&&n[0]===r.shift()){i=n.shift()}return i}function N(e,t,n){k("dispatchPointerEnter");var r=T(e,t),i=e,s=[];while(i&&i!==r){if(w(i,"touchenter")){s.push(i)}i=i.parentNode}while(s.length>0){n(s.pop())}}function C(e,t,n){k("dispatchPointerLeave");var r=T(e,t),i=e;while(i&&i!==r){if(w(i,"touchleave")){n(i)}i=i.parentNode}}function k(e){if(t){console.log(e.toString())}}var e=0,t=false,n=navigator.userAgent,r=["touchstart","touchmove","touchend","touchcancel","touchleave"],i={},s,o,u;l.prototype=window.Event.prototype;if(typeof window.ontouchstart==="object"){return}if(n.match(/iPad/i)||n.match(/iPhone/i)||n.match(/iPod/i)||n.match(/Android/i)||n.match(/MSIE/i)&&!n.match(/Touch/i)){return}(function(){var e="html { -ms-touch-action: none; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css";if(n.styleSheet){n.styleSheet.cssText=e}else{n.appendChild(document.createTextNode(e))}t.appendChild(n)})();s=new a;o=new a;u=new a;window.CustomEvent=l;m(window);m(window.HTMLElement||window.Element);m(document);m(HTMLBodyElement);m(HTMLDivElement);m(HTMLImageElement);m(HTMLUListElement);m(HTMLAnchorElement);m(HTMLLIElement);m(HTMLTableElement);if(window.HTMLSpanElement){m(HTMLSpanElement)}if(window.HTMLCanvasElement){m(HTMLCanvasElement)}if(window.SVGElement){m(SVGElement)}b(window);b(window.HTMLElement||window.Element);b(document);b(HTMLBodyElement);b(HTMLDivElement);b(HTMLImageElement);b(HTMLUListElement);b(HTMLAnchorElement);b(HTMLLIElement);b(HTMLTableElement);if(window.HTMLSpanElement){b(HTMLSpanElement)}if(window.HTMLCanvasElement){b(HTMLCanvasElement)}if(window.SVGElement){b(SVGElement)}(function(){function e(e){if(e.pointerType==="mouse")return true;if(e.pointerType==="pen"&&e.pressure===0&&e.type==="pointermove")return true;return false}window.addEventListener("pointerdown",function(t){k("pointerdownfired");var n=t;if(e(t)){return}i[n.identifier]=n.target;S("touchenter",n,n.target,t,true);N(n.target,null,function(e){p("touchenter",n,e,t,false)});S("touchstart",n,n.target,t,true)});window.addEventListener("pointerup",function(t){var n=t,r=i[n.identifier];k("pointer up fired");if(e(t)){return}S("touchend",n,r,t,true);S("touchleave",n,r,t,true);C(r,null,function(e){p("touchleave",n,e,t,false)})});window.addEventListener("pointermove",function(t){var n=t,r=i[n.identifier];k("pointer move fired");if(e(t)){return}k("x: "+t.screenX+", y: "+t.screenY);if(s.containsTouchAt(t.screenX,t.screenY)){return}if(r&&c(r)===true){t.preventDefault()}S("touchmove",n,r,t,true)})})()})()